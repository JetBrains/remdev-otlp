<idea-plugin>
    <dependencies>
        <module name="intellij.platform.frontend"/>
        <module name="OtpDiagnostic.shared"/>
    </dependencies>

    <applicationListeners>
        <listener topic="com.jetbrains.rdclient.connection.ClientSessionListener"
                  class="com.jetbrains.otp.connection.ClientSessionSpanUpdater"/>
    </applicationListeners>

    <extensions defaultExtensionNs="com.jetbrains.otp.diagnostic">
        <spanProcessorProvider implementation="com.jetbrains.otp.exporter.FrontendSpanProcessorProvider"/>
    </extensions>

    <extensions defaultExtensionNs="com.intellij">
        <openTelemetryExporterProvider implementation="com.jetbrains.otp.exporter.FrontendMetricExporter"/>

        <postStartupActivity implementation="com.jetbrains.otp.connection.ConnectionStateListener"/>

        <applicationConfigurable
            parentId="tools"
            instance="com.jetbrains.otp.settings.OtpDiagnosticConfigurable"
            id="com.jetbrains.otp.settings.OtpDiagnosticConfigurable"
            bundle="messages.OtpDiagnosticBundle"
            key="settings.displayName"/>

        <applicationService serviceInterface="com.jetbrains.otp.settings.SpanFilterService"
                            serviceImplementation="com.jetbrains.otp.settings.FrontendSpanFilterService"/>
    </extensions>
</idea-plugin>